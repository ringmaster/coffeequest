name: Baker's Flour
steps:
  - id: Bakery
    tags:
      - "!q:busy_baker"
      - "!done:busy_baker"
      - "!quest"
    vars:
      baked_item:
        - loaf of bread
        - pastry
        - small cake
    text: >-
      The frazzled baker greets you warmly. "I'd love to serve you a {{baked_item}}, but I'm all out of flour, and I am
      too busy to get to the market. Could you help me?"
    options:
      - label: I'll help you
        tags: []
        pass: bakery_accept_quest
      - label: Sorry, I'm busy
        tags: []
        pass: null
  - id: bakery_accept_quest
    tags:
      - +q:busy_baker
      - +quest
      - +inv:silver
      - +inv:silver
    text: >-
      The baker smiles gratefully. "Wonderful! Please visit the market and get some flour.  Here's some silver, which
      should be enough for a whole sack."
    log: Agreed to fetch flour for the baker
  - id: Bakery
    tags:
      - "!inv:flour"
      - q:busy_baker
    text: The baker is delighted to see you return, but is disapointed to see you don't have any flour.
    options:
      - Explore elsewhere
  - id: Bakery
    tags:
      - "@inv:flour"
      - q:busy_baker
    text: The baker is delighted to see you return with flour. 'Thank you! Here's a silver for your trouble.'
    options:
      - label: Accept payment
        tags: []
        pass: bakery_complete
  - id: bakery_complete
    tags:
      - "-inv:flour"
      - +inv:silver
      - +trait:assisted_baker
      - "-quest"
      - +done:busy_baker
      - +inv:{{baked_item}}
    text: The baker hands you a silver coin, a {{baked_item}}, and smiles warmly.
    log: Delivered flour to baker and earned silver
